<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Basic analysis and clonality • immunarch</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Basic analysis and clonality">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">immunarch</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/1_introduction.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/1_introduction.html">Introduction to `immunarch`</a>
    </li>
    <li>
      <a href="../articles/2_data.html">Working with data in `immunarch`</a>
    </li>
    <li>
      <a href="../articles/3_basic_analysis.html">Basic analysis and clonality</a>
    </li>
    <li>
      <a href="../articles/4_overlap.html">Repertoire overlap and public clonotypes</a>
    </li>
    <li>
      <a href="../articles/5_gene_usage.html">Gene usage analysis</a>
    </li>
    <li>
      <a href="../articles/6_diversity.html">Diversity estimation</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://immunomind.io">ImmunoMind</a>
</li>
<li>
  <a href="https://github.com/immunomind/immunarch">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Basic analysis and clonality</h1>
                        <h4 class="author"><a href="https://immunomind.io">ImmunoMind</a></h4>
            
            <h4 class="date"><a href="mailto:support@immunomind.io">support@immunomind.io</a></h4>
      
      
      <div class="hidden name"><code>3_basic_analysis.Rmd</code></div>

    </div>

    
    
<!--
%\VignetteEngine{knitr::rmarkdown}
%\VignetteIndexEntry{Introduction to immunarch}
%\VignettePackage{immunarch}
-->
<div id="basic-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#basic-analysis" class="anchor"></a>Basic analysis</h1>
<p>For each task in this section <code>immunarch</code> includes separate functions that are generally self-explanatory and are written in camel-case. Shorter names for the functions are also availbalie, although the authors do not recommend their usage for the sake of clarity and readability of the code. The latter are mentionned in parantheses. Basic analysis functions are:</p>
<ul>
<li><p><code>repExplore</code> (<code>rep.ex</code>) - to compute basic statistics, such as number of clones or distributions of lengths and counts. To explore them you need to pass the statistics, e.g. <code>count</code>, to the <code>.method</code>.</p></li>
<li><p><code>repClonality</code> (<code>rep.clo</code>) - to compute the clonality of repertoires.</p></li>
<li><p><code>repOverlap</code> (<code>rep.ov</code>) - to compute the repertoire overlap.</p></li>
<li><p><code>repOverlapAnalysis</code> (<code>rep.ova</code>) - to analyse the repertoire overlap, including different clustering procedures and PCA.</p></li>
<li><p><code>geneUsage</code> (<code>gen.us</code>) - to compute the distributions of V or J genes.</p></li>
<li><p><code>geneUsageAnalysis</code> (<code>gen.usa</code>) - to analyse the distributions of V or J genes, including clustering and PCA.</p></li>
<li><p><code>repDiversity</code> (<code>rep.div</code>) - to estimate the diversity of repertoires.</p></li>
<li><p><code>trackClonotypes</code> (<code>tr.clo</code>) - to analyse the dynamics of repertoires across time points.</p></li>
<li><p><code>spectratype</code> - to compute spectratype of clonotypes.</p></li>
</ul>
<p>Output of each function could be passed directly to the <code>vis</code> function - the general function for visualisation. Examples of usage are written below.</p>
<p>Plots generated by the <code>vis</code> function can be passed to <code>fixVis</code> - built-in software tool for making publication-ready plots. See the “Quick start” section for usage.</p>
<div id="exploratory-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#exploratory-analysis" class="anchor"></a>Exploratory analysis</h2>
<p>For the basic exploratory analysis such as comparing of number of reads / UMIs per repertoire or distribution use the function <code>repExplore</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">exp_len =<span class="st"> </span><span class="kw"><a href="../reference/repExplore.html">repExplore</a></span>(immdata<span class="op">$</span>data, <span class="dt">.method =</span> <span class="st">"len"</span>, <span class="dt">.col =</span> <span class="st">"aa"</span>)
exp_cnt =<span class="st"> </span><span class="kw"><a href="../reference/repExplore.html">repExplore</a></span>(immdata<span class="op">$</span>data, <span class="dt">.method =</span> <span class="st">"count"</span>)
exp_vol =<span class="st"> </span><span class="kw"><a href="../reference/repExplore.html">repExplore</a></span>(immdata<span class="op">$</span>data, <span class="dt">.method =</span> <span class="st">"volume"</span>)

p1 =<span class="st"> </span><span class="kw"><a href="../reference/vis.html">vis</a></span>(exp_len)
p2 =<span class="st"> </span><span class="kw"><a href="../reference/vis.html">vis</a></span>(exp_cnt)
p3 =<span class="st"> </span><span class="kw"><a href="../reference/vis.html">vis</a></span>(exp_vol)

p1</code></pre></div>
<p><img src="3_basic_analysis_files/figure-html/eda-1-1.png" width="1152" style="display: block; margin: auto;"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grid.arrange</span>(p2, p3, <span class="dt">ncol =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="3_basic_analysis_files/figure-html/eda-2-1.png" width="1344" style="display: block; margin: auto;"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># You can group samples by their metainformation</span>
p4 =<span class="st"> </span><span class="kw"><a href="../reference/vis.html">vis</a></span>(exp_len, <span class="dt">.by=</span><span class="st">"Status"</span>, <span class="dt">.meta=</span>immdata<span class="op">$</span>meta)
p5 =<span class="st"> </span><span class="kw"><a href="../reference/vis.html">vis</a></span>(exp_cnt, <span class="dt">.by=</span><span class="st">"Sex"</span>, <span class="dt">.meta=</span>immdata<span class="op">$</span>meta)
p6 =<span class="st"> </span><span class="kw"><a href="../reference/vis.html">vis</a></span>(exp_vol, <span class="dt">.by=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Status"</span>, <span class="st">"Sex"</span>), <span class="dt">.meta=</span>immdata<span class="op">$</span>meta)

p4</code></pre></div>
<p><img src="3_basic_analysis_files/figure-html/eda-3-1.png" width="960" style="display: block; margin: auto;"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grid.arrange</span>(p5, p6, <span class="dt">ncol =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="3_basic_analysis_files/figure-html/eda-4-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div id="clonality" class="section level2">
<h2 class="hasAnchor">
<a href="#clonality" class="anchor"></a>Clonality</h2>
<p>One of the ways to estimate the diversity of samples is to evaluate clonality. <code>repClonality</code> measures the amount of the most or the least frequent clonotypes. There are several methods to assess clonality, let us take a view of them. The <code>clonal.prop</code> method computes the proportion of repertoire occupied by the pools of cell clones:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">imm_pr =<span class="st"> </span><span class="kw"><a href="../reference/repClonality.html">repClonality</a></span>(immdata<span class="op">$</span>data, <span class="dt">.method =</span> <span class="st">"clonal.prop"</span>)
imm_pr</code></pre></div>
<pre><code>##         Clones Percentage Clonal.count.prop
## A2-i129     18       10.1      0.0023834746
## A2-i131     28       10.1      0.0036905233
## A2-i133      9       10.2      0.0012160519
## A2-i132    115       10.0      0.0145680263
## A4-i191      4       11.7      0.0006740816
## A4-i192      8       10.6      0.0011931394
## MS1          3       12.2      0.0004775549
## MS2         69       10.0      0.0083102493
## MS3          2       10.8      0.0002663116
## MS4        185       10.0      0.0213971779
## MS5          2       10.2      0.0003044603
## MS6        167       10.0      0.0193197594
## attr(,"class")
## [1] "matrix"             "immunr_clonal_prop"</code></pre>
<p>The <code>top</code> method considers the most abundant cell clonotypes:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">imm_top =<span class="st"> </span><span class="kw"><a href="../reference/repClonality.html">repClonality</a></span>(immdata<span class="op">$</span>data, <span class="dt">.method =</span> <span class="st">"top"</span>)
imm_top</code></pre></div>
<pre><code>##             10    100   1000   3000 10000 30000 1e+05
## A2-i129 0.0812 0.1735 0.3448 0.5448     1     1     1
## A2-i131 0.0671 0.1550 0.3413 0.5413     1     1     1
## A2-i133 0.1047 0.1815 0.3599 0.5599     1     1     1
## A2-i132 0.0242 0.0934 0.3077 0.5106     1     1     1
## A4-i191 0.1738 0.3201 0.5066 0.7066     1     1     1
## A4-i192 0.1182 0.2214 0.4295 0.6295     1     1     1
## MS1     0.1897 0.3050 0.4718 0.6718     1     1     1
## MS2     0.0442 0.1124 0.2697 0.4697     1     1     1
## MS3     0.1671 0.2321 0.3490 0.5490     1     1     1
## MS4     0.0235 0.0745 0.2354 0.4354     1     1     1
## MS5     0.2073 0.2907 0.4431 0.6431     1     1     1
## MS6     0.0279 0.0794 0.2356 0.4356     1     1     1
## attr(,"class")
## [1] "matrix"          "immunr_top_prop"</code></pre>
<p>While the <code>tail</code> method deals with the least prolific clonotypes:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">imm_tail =<span class="st"> </span><span class="kw"><a href="../reference/repClonality.html">repClonality</a></span>(immdata<span class="op">$</span>data, <span class="dt">.method =</span> <span class="st">"tail"</span>)
imm_tail</code></pre></div>
<pre><code>##              1      3     10     30    100
## A2-i129 0.6831 0.8112 0.8629 0.9217 0.9601
## A2-i131 0.6820 0.8152 0.8911 0.9298 0.9754
## A2-i133 0.6626 0.8025 0.8593 0.8982 0.9365
## A2-i132 0.6865 0.8721 0.9569 0.9946 1.0000
## A4-i191 0.5236 0.6343 0.7162 0.7653 0.8582
## A4-i192 0.5798 0.7371 0.8212 0.8654 0.9025
## MS1     0.5673 0.6661 0.7347 0.7918 0.8377
## MS2     0.7627 0.8856 0.9276 0.9690 0.9882
## MS3     0.7166 0.7733 0.7994 0.8329 0.8625
## MS4     0.7955 0.9258 0.9693 0.9902 1.0000
## MS5     0.6000 0.6953 0.7516 0.7799 0.8269
## MS6     0.7998 0.9182 0.9640 0.9867 1.0000
## attr(,"class")
## [1] "matrix"           "immunr_tail_prop"</code></pre>
<p>Finally, the <code>homeo</code> method assesses the clonal space homeostasis, i.e., the proportion of the repertoire occupied by the clones of a given size:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">imm_hom =<span class="st"> </span><span class="kw"><a href="../reference/repClonality.html">repClonality</a></span>(immdata<span class="op">$</span>data, <span class="dt">.method =</span> <span class="st">"homeo"</span>)
imm_hom</code></pre></div>
<pre><code>##         Rare (0 &lt; X &lt;= 1e-05) Small (1e-05 &lt; X &lt;= 1e-04)
## A2-i129                     0                     0.6831
## A2-i131                     0                     0.6820
## A2-i133                     0                     0.6626
## A2-i132                     0                     0.6865
## A4-i191                     0                     0.5236
## A4-i192                     0                     0.5798
## MS1                         0                     0.5673
## MS2                         0                     0.7627
## MS3                         0                     0.7166
## MS4                         0                     0.7955
## MS5                         0                     0.6000
## MS6                         0                     0.7998
##         Medium (1e-04 &lt; X &lt;= 0.001) Large (0.001 &lt; X &lt;= 0.01)
## A2-i129                      0.1798                    0.0972
## A2-i131                      0.2091                    0.0843
## A2-i133                      0.1967                    0.0772
## A2-i132                      0.2704                    0.0431
## A4-i191                      0.1926                    0.1420
## A4-i192                      0.2414                    0.0813
## MS1                          0.1674                    0.1030
## MS2                          0.1649                    0.0606
## MS3                          0.0828                    0.0631
## MS4                          0.1738                    0.0307
## MS5                          0.1516                    0.0753
## MS6                          0.1642                    0.0360
##         Hyperexpanded (0.01 &lt; X &lt;= 1)
## A2-i129                        0.0399
## A2-i131                        0.0246
## A2-i133                        0.0635
## A2-i132                        0.0000
## A4-i191                        0.1418
## A4-i192                        0.0975
## MS1                            0.1623
## MS2                            0.0118
## MS3                            0.1375
## MS4                            0.0000
## MS5                            0.1731
## MS6                            0.0000
## attr(,"class")
## [1] "matrix"       "immunr_homeo"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grid.arrange</span>(<span class="kw"><a href="../reference/vis.html">vis</a></span>(imm_top), <span class="kw"><a href="../reference/vis.html">vis</a></span>(imm_top, <span class="dt">.by=</span><span class="st">"Status"</span>, <span class="dt">.meta=</span>immdata<span class="op">$</span>meta), <span class="dt">ncol =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="3_basic_analysis_files/figure-html/clonality-hom-vis-1-1.png" width="1056" style="display: block; margin: auto;"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grid.arrange</span>(<span class="kw"><a href="../reference/vis.html">vis</a></span>(imm_tail), <span class="kw"><a href="../reference/vis.html">vis</a></span>(imm_tail, <span class="dt">.by=</span><span class="st">"Status"</span>, <span class="dt">.meta=</span>immdata<span class="op">$</span>meta), <span class="dt">ncol =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="3_basic_analysis_files/figure-html/clonality-hom-vis-1-2.png" width="1056" style="display: block; margin: auto;"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grid.arrange</span>(<span class="kw"><a href="../reference/vis.html">vis</a></span>(imm_hom), <span class="kw"><a href="../reference/vis.html">vis</a></span>(imm_hom, <span class="dt">.by=</span><span class="st">"Status"</span>, <span class="dt">.meta=</span>immdata<span class="op">$</span>meta), <span class="dt">ncol =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="3_basic_analysis_files/figure-html/clonality-hom-vis-1-3.png" width="1056" style="display: block; margin: auto;"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#basic-analysis">Basic analysis</a><ul class="nav nav-pills nav-stacked">
<li><a href="#exploratory-analysis">Exploratory analysis</a></li>
      <li><a href="#clonality">Clonality</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by  ImmunoMind.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
